(function(){AUI().use("json",function(d){var f;var b;var e;var a;var i;var h;var c={};var g=Liferay.Analytics.integration("LiferayAnalyticsProcessor").readyOnInitialize();g.prototype._ready=true;g.prototype.flush=function(l){var j=this;var k=j.getPendingEvents();e=false;if(k.length){if(f){f(h,{data:{events:d.JSON.stringify(k),themeDisplayData:d.JSON.stringify(c)},on:{failure:function(m){console.error(m.type)},success:function(){if(b(l)){l()}}}});j.store([]);a=clearInterval(a)}else{e=true}}};g.prototype.getPendingEvents=function(){var j=this;var k=localStorage.getItem("ct-analytics-events")||"[]";return d.JSON.parse(k)};g.prototype.initialize=function(){var j=this;i=j.options.interval;h=j.options.uri;AUI().use("aui-io-request",function(k){k.Object.each(themeDisplay,function(n,m){if(k.Lang.isFunction(n)){var o=/^(get|is)(.*)$/.exec(m)[2];var l=o.charAt(0);o=l.toLowerCase()+o.slice(1);c[o]=themeDisplay[m]()}});b=k.Lang.isFunction;f=k.io.request})};g.prototype.store=function(k){var j=this;k=k||[];localStorage.setItem("ct-analytics-events",d.JSON.stringify(k))};g.prototype.track=function(m,l){var j=this;var k=j.getPendingEvents();k.push(m.obj);j.store(k);if(!a){a=setTimeout(j.flush.bind(j),i)}};Liferay.Analytics.addIntegration(g)})})();